# Variable Group 'Process-as-Code Variables' was defined in the Variables tab
trigger:
  branches:
    include:
    - refs/heads/main
resources:
  repositories:
  - repository: self
    type: git
    ref: refs/heads/main
jobs:
- job: Job_1
  displayName: Agent job 1
  pool:
    name: Randy Agent
  steps:
  - checkout: self
    clean: true
    fetchTags: false
  - task: tsuyoshiushio.shell-exec.shellexec.shellexec@0
    displayName: Upload JSON application process changes to IBM DevOps Deploy
    inputs:
      code: "#export PATH=$PATH:/Users/rlange/Documents/git-ado/paac-0.1.0.1171817\nexport PATH=$PATH:/Users/rlange/Documents/git-ado/paac-2.0.1173150\n\npwd\nls -al\n\n# -----------------------------------------------------------------------\n# Change directory to the application folder (Process-as-Code-Example)\n# -----------------------------------------------------------------------\ncd Process-as-Code-Example\nls -al\n\n# -------------------------------------------------------------------------------------------------\n# 1.  Change directory to the JSON component process folder\n#\n#     Check for recent commits to the TXT files or JSON files in the folder.  \n#        TRUE -> If we find recent changes, run the \"upload-component-process\" command to\n#                       upload the changes to IBM DevOps Deploy\n#\n#        FALSE -> If no recent changes are found, no need to upload an update to the component \n#                        process\n# -------------------------------------------------------------------------------------------------\nls -al\nFOUND_CHANGES=false\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.txt\" -cmin -5`\ndo\n         echo Changes made to $name\n         FOUND_CHANGES=true\ndone\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.json\" -cmin -5`\ndo\n       echo Changes made to $name\n       FOUND_CHANGES=true\ndone\n\nif [[ $FOUND_CHANGES == \"true\" ]]\nthen\n      echo \"Changes were found to the application process.   Running the upload-application-process command...\"\n      #upload-component-process $(deploy-username) $(deploy-password) $(deploy-server-url) Deploy Process-as-Code deploy.json\n      upload-application-process $(deploy-username) $(deploy-password) $(deploy-server-url) deploy-paac.json \"$(Build.SourceVersionMessage)\"\n      echo \"Upload of application process was successful\"\nelse\n     echo \"No code changes found\"\nfi"
  - task: tsuyoshiushio.shell-exec.shellexec.shellexec@0
    displayName: Upload JSON component process changes to IBM DevOps Deploy
    inputs:
      code: "#export PATH=$PATH:/Users/rlange/Documents/git-ado/paac-0.1.0.1171817\nexport PATH=$PATH:/Users/rlange/Documents/git-ado/paac-2.0.1173150\n\npwd\nls -al\n\n# -----------------------------------------------------------------------\n# Change directory to the application folder (Process-as-Code-Example)\n# -----------------------------------------------------------------------\ncd Process-as-Code-Example\nls -al\n\n# -------------------------------------------------------------------------------------------------\n# 1.  Change directory to the JSON component process folder\n#\n#     Check for recent commits to the TXT files or JSON files in the folder.  \n#        TRUE -> If we find recent changes, run the \"upload-component-process\" command to\n#                       upload the changes to IBM DevOps Deploy\n#\n#        FALSE -> If no recent changes are found, no need to upload an update to the component \n#                        process\n# -------------------------------------------------------------------------------------------------\ncd Process-as-Code\nls -al\nFOUND_CHANGES=false\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.txt\" -cmin -5`\ndo\n         echo Changes made to $name\n         FOUND_CHANGES=true\ndone\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.json\" -cmin -5`\ndo\n       echo Changes made to $name\n       FOUND_CHANGES=true\ndone\n\nif [[ $FOUND_CHANGES == \"true\" ]]\nthen\n      echo \"Changes were found to the component process.   Running the upload-component-process command...\"\n      #upload-component-process $(deploy-username) $(deploy-password) $(deploy-server-url) Deploy Process-as-Code deploy.json\n      upload-component-process $(deploy-username) $(deploy-password) $(deploy-server-url) deploy.json \"$(Build.SourceVersionMessage)\"\n      echo \"Upload of component process was successful\"\nelse\n     echo \"No code changes found\"\nfi"
  - task: tsuyoshiushio.shell-exec.shellexec.shellexec@0
    displayName: Upload YAML component process changes to IBM DevOps Deploy copy
    inputs:
      code: "#export PATH=$PATH:/Users/rlange/Documents/git-ado/paac-0.1.0.1171817\nexport PATH=$PATH:/Users/rlange/Documents/git-ado/paac-2.0.1173150\n\npwd\nls -al\n\n# -----------------------------------------------------------------------\n# Change directory to the application folder (Process-as-Code-Example)\n# -----------------------------------------------------------------------\ncd Process-as-Code-Example\nls -al\n\n# -------------------------------------------------------------------------------------------------\n# 1.  Change directory to the YAML component process folder\n#\n#     Check for recent commits to the TXT files or JSON files in the folder.  \n#        TRUE -> If we find recent changes, run the \"upload-component-process\" command to\n#                       upload the changes to IBM DevOps Deploy\n#\n#        FALSE -> If no recent changes are found, no need to upload an update to the component \n#                        process\n# -------------------------------------------------------------------------------------------------\ncd Process-as-Code-YAML\nls -al\nFOUND_CHANGES=false\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.txt\" -cmin -5`\ndo\n         echo Changes made to $name\n         FOUND_CHANGES=true\ndone\n\n######\n# The -cmin 5 is used to check to changes in the last 5 minutes\n######\nfor name in `find . -name \"*.yaml\" -cmin -5`\ndo\n         echo Changes made to $name\n         FOUND_CHANGES=true\ndone\n\nif [[ $FOUND_CHANGES == \"true\" ]]\nthen\n      echo \"Changes were found to the component process.   Running the upload-component-process command...\"\n      upload-component-process $(deploy-username) $(deploy-password) $(deploy-server-url) deploy.yaml \"$(Build.SourceVersionMessage)\"\n      echo \"Upload of component process was successful\"\nelse\n     echo \"No code changes found\"\nfi"
...
